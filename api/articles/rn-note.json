{"title":"ReactNative - 开发笔记","slug":"rn-note","date":"2020-01-07T06:31:05.000Z","updated":"2020-05-09T07:34:06.000Z","comments":true,"path":"api/articles/rn-note.json","realPath":"/2020/01/07/rn-note/","excerpt":"关于React-Native的一些记录和总结。","covers":["https://pic.izhaoo.com/20200509114652.jpg","https://pic.izhaoo.com/20200509153325.png"],"cover":"https://pic.izhaoo.com/20200125103152.jpg","content":"<p>关于<code>React-Native</code>的一些记录和总结。</p>\n<span id=\"more\"></span>\n\n<h3 id=\"插件\"><a href=\"#插件\" class=\"headerlink\" title=\"插件\"></a>插件</h3><ul>\n<li>路由导航：<a href=\"https://reactnavigation.org/\">react-navigation</a></li>\n<li>UI组件：<a href=\"https://react-native-elements.github.io/react-native-elements/\">react-native-elements</a></li>\n<li>网络请求：<a href=\"https://github.com/axios/axios\">axios</a></li>\n<li>状态管理：<a href=\"https://redux.js.org/\">redux</a>、<a href=\"https://github.com/reduxjs/redux-thunk\">redux-thunk</a>、<a href=\"https://github.com/reduxjs/react-redux\">react-redux</a></li>\n<li>Icon图标：<a href=\"https://github.com/oblador/react-native-vector-icons\">react-native-vector-icons</a></li>\n<li>轮播图：<a href=\"https://github.com/leecade/react-native-swiper\">react-native-swiper</a></li>\n<li>支付宝：<a href=\"https://github.com/0x5e/react-native-alipay\">react-native-alipay</a></li>\n<li>百度地图：<a href=\"https://github.com/lovebing/react-native-baidu-map\">react-native-baidu-map</a></li>\n<li>弹出输入框：<a href=\"https://github.com/joseestrella89/react-native-dialog-input\">react-native-dialog-input</a></li>\n<li>HTML渲染：<a href=\"https://github.com/jsdf/react-native-htmlview\">react-native-htmlview</a></li>\n<li>欢迎页：<a href=\"https://github.com/Jacse/react-native-app-intro-slider\">react-native-app-intro-slider</a></li>\n<li>日期时间选择：<a href=\"https://github.com/react-native-community/react-native-datetimepicker\">datetimepicker</a></li>\n<li>Fab按钮：<a href=\"https://github.com/mastermoo/react-native-action-button\">react-native-action-button</a></li>\n<li>组件相对路径：<a href=\"https://github.com/entwicklerstube/babel-plugin-root-import\">babel-plugin-root-import</a></li>\n</ul>\n<h3 id=\"踩坑记录\"><a href=\"#踩坑记录\" class=\"headerlink\" title=\"踩坑记录\"></a>踩坑记录</h3><h5 id=\"本地请求失败\"><a href=\"#本地请求失败\" class=\"headerlink\" title=\"本地请求失败\"></a>本地请求失败</h5><p>在请求本地服务器<code>http://127.0.0.1:7001</code>的时候怎么也访问不到。后来才了解到原来使用<code>Android Studio</code>虚拟机，需要访问<strong><a href=\"http://10.0.2.2:28080\">http://10.0.2.2:28080</a></strong>，相当于开了两台局域网主机嘛。</p>\n<blockquote>\n<p><a href=\"https://stackoverflow.com/questions/42189301/axios-in-react-native-not-calling-server-in-localhost\"><a href=\"https://stackoverflow.com/questions/42189301/axios-in-react-native-not-calling-server-in-localhost\">Axios (in React-native) not calling server in localhost</a></a></p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://github.com/axios/axios/issues/973\">Axios doesn’t work with Android (emulator) raising a Network Error</a></p>\n</blockquote>\n<h5 id=\"导航标题不居中\"><a href=\"#导航标题不居中\" class=\"headerlink\" title=\"导航标题不居中\"></a>导航标题不居中</h5><p><code>react-navigation</code>标题在安卓上默认显示在左边，想在左边做一个回退按钮，按照官方文档设置了标题居中，并没有起效果。解决方案如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-keyword\">static</span> navigationOptions = &#123; <br>\t<span class=\"hljs-attr\">headerTitleStyle</span>:&#123;<br>\t\t<span class=\"hljs-attr\">flex</span>: <span class=\"hljs-number\">1</span>,<br>\t\t<span class=\"hljs-attr\">textAlign</span>: <span class=\"hljs-string\">&#x27;center&#x27;</span>,<br>\t&#125;, <br>&#125;<br></code></pre></td></tr></table></figure>\n\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/alex-huanglintian/p/8641255.html\"><a href=\"https://www.cnblogs.com/alex-huanglintian/p/8641255.html\">react-navigation 标题在安卓上不居中问题</a></a></p>\n</blockquote>\n<h5 id=\"打包无法联网\"><a href=\"#打包无法联网\" class=\"headerlink\" title=\"打包无法联网\"></a>打包无法联网</h5><p>安卓9开始需要添加配置才能开启联网权限。解决方案如下：</p>\n<ol>\n<li><p>在<code>/src/main/res</code>创建<code>network_security_config.xml</code>文件，内写代码：</p>\n  <figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><code class=\"hljs xml\">\t <span class=\"hljs-meta\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">network-security-config</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">base-config</span> <span class=\"hljs-attr\">cleartextTrafficPermitted</span>=<span class=\"hljs-string\">&quot;true&quot;</span> /&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">network-security-config</span>&gt;</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>在<code>/src/main/androidManifest.xml</code>加入如下代码：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">application</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:name</span>=<span class=\"hljs-string\">&quot;.MainApplication&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:label</span>=<span class=\"hljs-string\">&quot;@string/app_name&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:icon</span>=<span class=\"hljs-string\">&quot;@mipmap/ic_launcher&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:networkSecurityConfig</span>=<span class=\"hljs-string\">&quot;@xml/network_security_config&quot;</span>\t//<span class=\"hljs-attr\">Add</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:roundIcon</span>=<span class=\"hljs-string\">&quot;@mipmap/ic_launcher_round&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:allowBackup</span>=<span class=\"hljs-string\">&quot;false&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:theme</span>=<span class=\"hljs-string\">&quot;@style/AppTheme&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n\n</li>\n</ol>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/qq_36538734/article/details/90476288\">react native 0.595 在安卓9.0版 release包无法联网</a></p>\n</blockquote>\n<h5 id=\"支付宝开启沙箱\"><a href=\"#支付宝开启沙箱\" class=\"headerlink\" title=\"支付宝开启沙箱\"></a>支付宝开启沙箱</h5><p>开发支付业务时用到的第三方封装支付宝插件，但是没有集成沙箱环境，按以下方式集成。</p>\n<ol>\n<li><p><code>android/src/main/java/com/reactlibrary/AlipayModule.java</code>中添加以下代码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.reactlibrary;<br><br><span class=\"hljs-keyword\">import</span> com.alipay.sdk.app.EnvUtils;\t<span class=\"hljs-comment\">//Add</span><br><span class=\"hljs-keyword\">import</span> com.alipay.sdk.app.H5PayCallback;<br><span class=\"hljs-keyword\">import</span> com.alipay.sdk.util.H5PayResultModel;<br><span class=\"hljs-keyword\">import</span> com.alipay.sdk.app.AuthTask;<br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">run</span><span class=\"hljs-params\">()</span> </span>&#123;<br>\tthread.start();<br>&#125;<br><br><span class=\"hljs-comment\">// Add</span><br><span class=\"hljs-meta\">@ReactMethod</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setAlipaySandbox</span><span class=\"hljs-params\">(Boolean isSandbox)</span> </span>&#123;<br>  <span class=\"hljs-keyword\">if</span>(isSandbox)&#123;<br>    EnvUtils.setEnv(EnvUtils.EnvEnum.SANDBOX);<br>  &#125;<span class=\"hljs-keyword\">else</span> &#123;<br>    EnvUtils.setEnv(EnvUtils.EnvEnum.ONLINE);<br>  &#125;<br>&#125;<br><br><span class=\"hljs-meta\">@ReactMethod</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">pay</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">final</span> String orderInfo, <span class=\"hljs-keyword\">final</span> Promise promise)</span> </span>&#123;<br>  Runnable runnable = <span class=\"hljs-keyword\">new</span> Runnable() &#123;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p><code>index.d.ts</code>中添加以下代码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-function\">function <span class=\"hljs-title\">authWithInfo</span><span class=\"hljs-params\">(infoStr: string)</span>: IResult</span>;<br><br><span class=\"hljs-comment\">// Add</span><br><span class=\"hljs-function\">function <span class=\"hljs-title\">setAlipaySandbox</span><span class=\"hljs-params\">(isSandbox: <span class=\"hljs-keyword\">boolean</span>)</span>: <span class=\"hljs-keyword\">void</span></span><br><span class=\"hljs-function\"></span><br><span class=\"hljs-function\">function <span class=\"hljs-title\">pay</span><span class=\"hljs-params\">(infoStr: string)</span>: IResult</span>;<br><br><span class=\"hljs-function\">function <span class=\"hljs-title\">payInterceptorWithUrl</span><span class=\"hljs-params\">(infoStr: string)</span>: </span>&#123;<br></code></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<blockquote>\n<p><a href=\"https://github.com/0x5e/react-native-alipay/pull/40/commits/36a7347c6e9ca1cbd3457c7ef93d620448bb9f29\">add sandbox</a></p>\n</blockquote>\n<h3 id=\"组件导入相对路径配置\"><a href=\"#组件导入相对路径配置\" class=\"headerlink\" title=\"组件导入相对路径配置\"></a>组件导入相对路径配置</h3><p>安装并配置插件<code>babel-plugin-root-import</code>即可。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><code class=\"hljs javascript\">yarn add babel-plugin-root-<span class=\"hljs-keyword\">import</span>    <span class=\"hljs-comment\">// 下载插件</span><br><br><span class=\"hljs-attr\">plugins</span>: [    <span class=\"hljs-comment\">// 加入 babel.config.js 配置</span><br>    [<br>      <span class=\"hljs-string\">&#x27;babel-plugin-root-import&#x27;</span>,<br>      &#123;<br>        <span class=\"hljs-attr\">rootPathSuffix</span>: <span class=\"hljs-string\">&#x27;src&#x27;</span>,<br>      &#125;,<br>    ],<br>  ],<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"获取sha1\"><a href=\"#获取sha1\" class=\"headerlink\" title=\"获取sha1\"></a>获取sha1</h3><p>在使用 <a href=\"https://github.com/lovebing/react-native-baidu-map\">react-native-baidu-map</a> 过程中，发现 <code>reverseGeoCode</code> 等一些功能无法使用，且在RN控制台没有报错。</p>\n<p>后来在 <code>Android Studio</code> 打包时发现原生模块报错，原来是 <code>百度地图SKD</code> 中的 <strong>开发版sha1</strong> 和 <strong>发布版sha1</strong> 没有配置正确。</p>\n<p><img  src=\"https://pic.izhaoo.com/20200509114652.jpg\"  ><span class=\"image-caption\">百度地图bug</span></p>\n<p>获取方法如下:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ <span class=\"hljs-built_in\">cd</span> ./android/app<br></code></pre></td></tr></table></figure>\n\n<p>可以看到 <code>debug.keystore</code> 和 <code>release.keystore</code> 签名文件。（具体文件名可能不同）</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">keytool -list -v -keystore debug.keystore  <span class=\"hljs-comment\">#获取开发版sha1</span><br></code></pre></td></tr></table></figure>\n\n<p><img  src=\"https://pic.izhaoo.com/20200509153325.png\"  ><span class=\"image-caption\">开发版sha1</span></p>\n<p>提示 <code>输入秘钥库密码</code> ，直接回车，即可获取 <code>开发版sha1</code>。</p>\n<p><code>发布版sha1</code> 同理:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">keytool -list -v -keystore release.keystore  <span class=\"hljs-comment\">#获取发布版sha1</span><br></code></pre></td></tr></table></figure>","more":"<h3 id=\"插件\"><a href=\"#插件\" class=\"headerlink\" title=\"插件\"></a>插件</h3><ul>\n<li>路由导航：<a href=\"https://reactnavigation.org/\">react-navigation</a></li>\n<li>UI组件：<a href=\"https://react-native-elements.github.io/react-native-elements/\">react-native-elements</a></li>\n<li>网络请求：<a href=\"https://github.com/axios/axios\">axios</a></li>\n<li>状态管理：<a href=\"https://redux.js.org/\">redux</a>、<a href=\"https://github.com/reduxjs/redux-thunk\">redux-thunk</a>、<a href=\"https://github.com/reduxjs/react-redux\">react-redux</a></li>\n<li>Icon图标：<a href=\"https://github.com/oblador/react-native-vector-icons\">react-native-vector-icons</a></li>\n<li>轮播图：<a href=\"https://github.com/leecade/react-native-swiper\">react-native-swiper</a></li>\n<li>支付宝：<a href=\"https://github.com/0x5e/react-native-alipay\">react-native-alipay</a></li>\n<li>百度地图：<a href=\"https://github.com/lovebing/react-native-baidu-map\">react-native-baidu-map</a></li>\n<li>弹出输入框：<a href=\"https://github.com/joseestrella89/react-native-dialog-input\">react-native-dialog-input</a></li>\n<li>HTML渲染：<a href=\"https://github.com/jsdf/react-native-htmlview\">react-native-htmlview</a></li>\n<li>欢迎页：<a href=\"https://github.com/Jacse/react-native-app-intro-slider\">react-native-app-intro-slider</a></li>\n<li>日期时间选择：<a href=\"https://github.com/react-native-community/react-native-datetimepicker\">datetimepicker</a></li>\n<li>Fab按钮：<a href=\"https://github.com/mastermoo/react-native-action-button\">react-native-action-button</a></li>\n<li>组件相对路径：<a href=\"https://github.com/entwicklerstube/babel-plugin-root-import\">babel-plugin-root-import</a></li>\n</ul>\n<h3 id=\"踩坑记录\"><a href=\"#踩坑记录\" class=\"headerlink\" title=\"踩坑记录\"></a>踩坑记录</h3><h5 id=\"本地请求失败\"><a href=\"#本地请求失败\" class=\"headerlink\" title=\"本地请求失败\"></a>本地请求失败</h5><p>在请求本地服务器<code>http://127.0.0.1:7001</code>的时候怎么也访问不到。后来才了解到原来使用<code>Android Studio</code>虚拟机，需要访问<strong><a href=\"http://10.0.2.2:28080\">http://10.0.2.2:28080</a></strong>，相当于开了两台局域网主机嘛。</p>\n<blockquote>\n<p><a href=\"https://stackoverflow.com/questions/42189301/axios-in-react-native-not-calling-server-in-localhost\"><a href=\"https://stackoverflow.com/questions/42189301/axios-in-react-native-not-calling-server-in-localhost\">Axios (in React-native) not calling server in localhost</a></a></p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://github.com/axios/axios/issues/973\">Axios doesn’t work with Android (emulator) raising a Network Error</a></p>\n</blockquote>\n<h5 id=\"导航标题不居中\"><a href=\"#导航标题不居中\" class=\"headerlink\" title=\"导航标题不居中\"></a>导航标题不居中</h5><p><code>react-navigation</code>标题在安卓上默认显示在左边，想在左边做一个回退按钮，按照官方文档设置了标题居中，并没有起效果。解决方案如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-keyword\">static</span> navigationOptions = &#123; <br>\t<span class=\"hljs-attr\">headerTitleStyle</span>:&#123;<br>\t\t<span class=\"hljs-attr\">flex</span>: <span class=\"hljs-number\">1</span>,<br>\t\t<span class=\"hljs-attr\">textAlign</span>: <span class=\"hljs-string\">&#x27;center&#x27;</span>,<br>\t&#125;, <br>&#125;<br></code></pre></td></tr></table></figure>\n\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/alex-huanglintian/p/8641255.html\"><a href=\"https://www.cnblogs.com/alex-huanglintian/p/8641255.html\">react-navigation 标题在安卓上不居中问题</a></a></p>\n</blockquote>\n<h5 id=\"打包无法联网\"><a href=\"#打包无法联网\" class=\"headerlink\" title=\"打包无法联网\"></a>打包无法联网</h5><p>安卓9开始需要添加配置才能开启联网权限。解决方案如下：</p>\n<ol>\n<li><p>在<code>/src/main/res</code>创建<code>network_security_config.xml</code>文件，内写代码：</p>\n  <figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><code class=\"hljs xml\">\t <span class=\"hljs-meta\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">network-security-config</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">base-config</span> <span class=\"hljs-attr\">cleartextTrafficPermitted</span>=<span class=\"hljs-string\">&quot;true&quot;</span> /&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">network-security-config</span>&gt;</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>在<code>/src/main/androidManifest.xml</code>加入如下代码：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">application</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:name</span>=<span class=\"hljs-string\">&quot;.MainApplication&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:label</span>=<span class=\"hljs-string\">&quot;@string/app_name&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:icon</span>=<span class=\"hljs-string\">&quot;@mipmap/ic_launcher&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:networkSecurityConfig</span>=<span class=\"hljs-string\">&quot;@xml/network_security_config&quot;</span>\t//<span class=\"hljs-attr\">Add</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:roundIcon</span>=<span class=\"hljs-string\">&quot;@mipmap/ic_launcher_round&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:allowBackup</span>=<span class=\"hljs-string\">&quot;false&quot;</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">android:theme</span>=<span class=\"hljs-string\">&quot;@style/AppTheme&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n\n</li>\n</ol>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/qq_36538734/article/details/90476288\">react native 0.595 在安卓9.0版 release包无法联网</a></p>\n</blockquote>\n<h5 id=\"支付宝开启沙箱\"><a href=\"#支付宝开启沙箱\" class=\"headerlink\" title=\"支付宝开启沙箱\"></a>支付宝开启沙箱</h5><p>开发支付业务时用到的第三方封装支付宝插件，但是没有集成沙箱环境，按以下方式集成。</p>\n<ol>\n<li><p><code>android/src/main/java/com/reactlibrary/AlipayModule.java</code>中添加以下代码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.reactlibrary;<br><br><span class=\"hljs-keyword\">import</span> com.alipay.sdk.app.EnvUtils;\t<span class=\"hljs-comment\">//Add</span><br><span class=\"hljs-keyword\">import</span> com.alipay.sdk.app.H5PayCallback;<br><span class=\"hljs-keyword\">import</span> com.alipay.sdk.util.H5PayResultModel;<br><span class=\"hljs-keyword\">import</span> com.alipay.sdk.app.AuthTask;<br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">run</span><span class=\"hljs-params\">()</span> </span>&#123;<br>\tthread.start();<br>&#125;<br><br><span class=\"hljs-comment\">// Add</span><br><span class=\"hljs-meta\">@ReactMethod</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setAlipaySandbox</span><span class=\"hljs-params\">(Boolean isSandbox)</span> </span>&#123;<br>  <span class=\"hljs-keyword\">if</span>(isSandbox)&#123;<br>    EnvUtils.setEnv(EnvUtils.EnvEnum.SANDBOX);<br>  &#125;<span class=\"hljs-keyword\">else</span> &#123;<br>    EnvUtils.setEnv(EnvUtils.EnvEnum.ONLINE);<br>  &#125;<br>&#125;<br><br><span class=\"hljs-meta\">@ReactMethod</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">pay</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">final</span> String orderInfo, <span class=\"hljs-keyword\">final</span> Promise promise)</span> </span>&#123;<br>  Runnable runnable = <span class=\"hljs-keyword\">new</span> Runnable() &#123;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p><code>index.d.ts</code>中添加以下代码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-function\">function <span class=\"hljs-title\">authWithInfo</span><span class=\"hljs-params\">(infoStr: string)</span>: IResult</span>;<br><br><span class=\"hljs-comment\">// Add</span><br><span class=\"hljs-function\">function <span class=\"hljs-title\">setAlipaySandbox</span><span class=\"hljs-params\">(isSandbox: <span class=\"hljs-keyword\">boolean</span>)</span>: <span class=\"hljs-keyword\">void</span></span><br><span class=\"hljs-function\"></span><br><span class=\"hljs-function\">function <span class=\"hljs-title\">pay</span><span class=\"hljs-params\">(infoStr: string)</span>: IResult</span>;<br><br><span class=\"hljs-function\">function <span class=\"hljs-title\">payInterceptorWithUrl</span><span class=\"hljs-params\">(infoStr: string)</span>: </span>&#123;<br></code></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<blockquote>\n<p><a href=\"https://github.com/0x5e/react-native-alipay/pull/40/commits/36a7347c6e9ca1cbd3457c7ef93d620448bb9f29\">add sandbox</a></p>\n</blockquote>\n<h3 id=\"组件导入相对路径配置\"><a href=\"#组件导入相对路径配置\" class=\"headerlink\" title=\"组件导入相对路径配置\"></a>组件导入相对路径配置</h3><p>安装并配置插件<code>babel-plugin-root-import</code>即可。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><code class=\"hljs javascript\">yarn add babel-plugin-root-<span class=\"hljs-keyword\">import</span>    <span class=\"hljs-comment\">// 下载插件</span><br><br><span class=\"hljs-attr\">plugins</span>: [    <span class=\"hljs-comment\">// 加入 babel.config.js 配置</span><br>    [<br>      <span class=\"hljs-string\">&#x27;babel-plugin-root-import&#x27;</span>,<br>      &#123;<br>        <span class=\"hljs-attr\">rootPathSuffix</span>: <span class=\"hljs-string\">&#x27;src&#x27;</span>,<br>      &#125;,<br>    ],<br>  ],<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"获取sha1\"><a href=\"#获取sha1\" class=\"headerlink\" title=\"获取sha1\"></a>获取sha1</h3><p>在使用 <a href=\"https://github.com/lovebing/react-native-baidu-map\">react-native-baidu-map</a> 过程中，发现 <code>reverseGeoCode</code> 等一些功能无法使用，且在RN控制台没有报错。</p>\n<p>后来在 <code>Android Studio</code> 打包时发现原生模块报错，原来是 <code>百度地图SKD</code> 中的 <strong>开发版sha1</strong> 和 <strong>发布版sha1</strong> 没有配置正确。</p>\n<p><img  src=\"https://pic.izhaoo.com/20200509114652.jpg\"  ><span class=\"image-caption\">百度地图bug</span></p>\n<p>获取方法如下:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ <span class=\"hljs-built_in\">cd</span> ./android/app<br></code></pre></td></tr></table></figure>\n\n<p>可以看到 <code>debug.keystore</code> 和 <code>release.keystore</code> 签名文件。（具体文件名可能不同）</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">keytool -list -v -keystore debug.keystore  <span class=\"hljs-comment\">#获取开发版sha1</span><br></code></pre></td></tr></table></figure>\n\n<p><img  src=\"https://pic.izhaoo.com/20200509153325.png\"  ><span class=\"image-caption\">开发版sha1</span></p>\n<p>提示 <code>输入秘钥库密码</code> ，直接回车，即可获取 <code>开发版sha1</code>。</p>\n<p><code>发布版sha1</code> 同理:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">keytool -list -v -keystore release.keystore  <span class=\"hljs-comment\">#获取发布版sha1</span><br></code></pre></td></tr></table></figure>","categories":[{"name":"前端","path":"api/categories/前端.json"}],"tags":[{"name":"前端","path":"api/tags/前端.json"}]}