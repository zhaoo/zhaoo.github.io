{"title":"小程序部署文档","slug":"hexo-weapp-zhaoo-doc","date":"2021-07-05T05:23:18.000Z","updated":"2021-09-16T15:50:10.833Z","comments":true,"path":"api/articles/hexo-weapp-zhaoo-doc.json","realPath":"/2021/07/05/hexo-weapp-zhaoo-doc/","excerpt":"zhaoo 主题孪生小程序的相关部署文档。","covers":["https://pic.izhaoo.com/weapp-code.jpg","https://pic.izhaoo.com/20210705142146.jpg","https://pic.izhaoo.com/20210705195454.jpg","https://pic.izhaoo.com/20210705202742.jpg","https://pic.izhaoo.com/20210705203106.jpg","https://pic.izhaoo.com/20210705203440.jpg"],"cover":"https://pic.izhaoo.com/20210628214443.jpg","content":"<p><code>zhaoo</code> 主题孪生小程序的相关部署文档。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"hexo-weapp-zhaoo\"><a href=\"#hexo-weapp-zhaoo\" class=\"headerlink\" title=\"hexo-weapp-zhaoo\"></a>hexo-weapp-zhaoo</h2><p style=\"text-align: center; font-weight: bold;\"><a href=\"https://github.com/zhaoo/hexo-weapp-zhaoo\" target=\"_blank\">hexo-weapp-zhaoo</a></p>\n\n<p style=\"text-align: center; font-weight: bold;\">为 Hexo 定制的博客小程序</p>\n\n<p><img  src=\"https://pic.izhaoo.com/weapp-code.jpg\"  ><span class=\"image-caption\">扫码预览</span></p>\n<h2 id=\"关于文档\"><a href=\"#关于文档\" class=\"headerlink\" title=\"关于文档\"></a>关于文档</h2><blockquote>\n<p>如有疑惑欢迎加鹅群咨询：<strong>550262893</strong><br>需要使用者具备一丢丢的前端基础。</p>\n</blockquote>\n<p style=\"text-align: right;\">文档更新于：2021年07月05日</p>\n\n<h2 id=\"RESTful\"><a href=\"#RESTful\" class=\"headerlink\" title=\"RESTful\"></a>RESTful</h2><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p>首先需要使用 <a href=\"https://github.com/zhaoo/hexo-generator-restful-zhaoo\">hexo-generator-restful-zhaoo</a> 插件生成 RESTful 接口，为小程序提供后端服务。</p>\n<p><code>cd</code> 到博客根目录，执行以下命令安装插件：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ npm install hexo-generator-restful-zhaoo --save  <span class=\"hljs-comment\"># 安装插件</span><br>$ hexo g  <span class=\"hljs-comment\"># 生成静态页面</span><br></code></pre></td></tr></table></figure>\n\n<p>生成静态页面后可在 <code>public</code> 目录下找到 <code>api</code> 目录，里面存放的是一些 <code>json</code> 格式的文本数据，直接访问这些 <code>json</code> 文件即可调用接口。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705142146.jpg\"  ><span class=\"image-caption\">调用接口</span></p>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>该插件暴露了一些配置项供用户进行自定义配置，在博客根目录下的 <code>_config.yml</code> 配置文件末尾插入以下内容进行配置：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"code\"><pre><code class=\"hljs yml\"><span class=\"hljs-comment\"># 以下为缺省默认项</span><br><br><span class=\"hljs-attr\">restful:</span><br>  <span class=\"hljs-comment\"># site 可配置为数组选择性生成某些属性</span><br>  <span class=\"hljs-comment\"># site: [&#x27;title&#x27;, &#x27;subtitle&#x27;, &#x27;description&#x27;, &#x27;author&#x27;, &#x27;since&#x27;, email&#x27;, &#x27;favicon&#x27;, &#x27;avatar&#x27;]</span><br>  <span class=\"hljs-attr\">site:</span> <span class=\"hljs-literal\">true</span>        <span class=\"hljs-comment\"># hexo.config mix theme.config</span><br>  <span class=\"hljs-attr\">posts_size:</span> <span class=\"hljs-number\">10</span>    <span class=\"hljs-comment\"># 文章列表分页，0 表示不分页</span><br>  <span class=\"hljs-attr\">posts_props:</span>      <span class=\"hljs-comment\"># 文章列表项的需要生成的属性</span><br>    <span class=\"hljs-attr\">title:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">slug:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">date:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">updated:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">comments:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">path:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">excerpt:</span> <span class=\"hljs-literal\">false</span><br>    <span class=\"hljs-attr\">cover:</span> <span class=\"hljs-literal\">true</span>      <span class=\"hljs-comment\"># 封面图，取文章第一张图片</span><br>    <span class=\"hljs-attr\">content:</span> <span class=\"hljs-literal\">false</span><br>    <span class=\"hljs-attr\">keywords:</span> <span class=\"hljs-literal\">false</span><br>    <span class=\"hljs-attr\">categories:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">tags:</span> <span class=\"hljs-literal\">true</span><br>  <span class=\"hljs-attr\">categories:</span> <span class=\"hljs-literal\">true</span>         <span class=\"hljs-comment\"># 分类数据</span><br>  <span class=\"hljs-attr\">use_category_slug:</span> <span class=\"hljs-literal\">false</span> <span class=\"hljs-comment\"># Use slug for filename of category data</span><br>  <span class=\"hljs-attr\">tags:</span> <span class=\"hljs-literal\">true</span>               <span class=\"hljs-comment\"># 标签数据</span><br>  <span class=\"hljs-attr\">use_tag_slug:</span> <span class=\"hljs-literal\">false</span>      <span class=\"hljs-comment\"># Use slug for filename of tag data</span><br>  <span class=\"hljs-attr\">post:</span> <span class=\"hljs-literal\">true</span>               <span class=\"hljs-comment\"># 文章数据</span><br>  <span class=\"hljs-attr\">pages:</span> <span class=\"hljs-literal\">false</span>             <span class=\"hljs-comment\"># 额外的 Hexo 页面数据, 如 About</span><br>  <span class=\"hljs-attr\">galleries:</span> <span class=\"hljs-literal\">false</span>         <span class=\"hljs-comment\"># 相册数据 </span><br></code></pre></td></tr></table></figure>\n\n<p>修改配置项后需要使用 <code>hexo g</code> 命令重新生成页面。</p>\n<h2 id=\"小程序\"><a href=\"#小程序\" class=\"headerlink\" title=\"小程序\"></a>小程序</h2><h3 id=\"注册\"><a href=\"#注册\" class=\"headerlink\" title=\"注册\"></a>注册</h3><p>首先需要在<a href=\"https://mp.weixin.qq.com/cgi-bin/registermidpage?action=index&lang=zh_CN&token=\">微信公众平台</a>注册一个小程序，填写基本信息即可。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705195454.jpg\"  ><span class=\"image-caption\">注册小程序</span></p>\n<p>注册完成后进入后台，在 <em>设置 → 基本设置</em> 中可以获取到 <strong>AppID</strong>，后面会使用到。</p>\n<p>在 <em>开发 → 开发管理 → 开发设置</em> 中添加 <em>request合法域名</em>，否则会被拦截，需要添加以下域名：</p>\n<ol>\n<li>RESTful 接口域名（例如：<a href=\"https://www.izhaoo.com）\">https://www.izhaoo.com）</a></li>\n<li><a href=\"https://api.leancloud.cn\">https://api.leancloud.cn</a> （第三方数据统计服务）</li>\n</ol>\n<h3 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h3><blockquote>\n<p>小程序基于 <a href=\"https://taro.aotu.io/\">Taro</a> 开发，建议阅读 <a href=\"https://taro-docs.jd.com/taro/docs/README\">Taro 官方文档</a> 了解更多姿势。</p>\n</blockquote>\n<p>首先需要安装 Taro <strong>（安全起见，建议安装 3.2.1 版本）</strong>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ npm install -g @tarojs/cli@3.2.1  <span class=\"hljs-comment\"># 安装 Taro</span><br>$ npm info @tarojs/cli  <span class=\"hljs-comment\"># 查看 Taro 版本</span><br></code></pre></td></tr></table></figure>\n\n<p>在任意目录下拉取 <a href=\"https://github.com/zhaoo/hexo-weapp-zhaoo\">hexo-weapp-zhaoo</a> 最新代码（直接打包下载也行）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ git <span class=\"hljs-built_in\">clone</span> https://github.com/zhaoo/hexo-weapp-zhaoo.git<br></code></pre></td></tr></table></figure>\n\n<p>执行以下命令打包小程序：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ <span class=\"hljs-built_in\">cd</span> client  <span class=\"hljs-comment\"># 移动到客户端目录</span><br>$ npm run build:weapp  <span class=\"hljs-comment\"># 打包</span><br></code></pre></td></tr></table></figure>\n\n<p>执行后会在当前目录下生成 <code>dist</code> 目录（小程序编译目标）。</p>\n<h3 id=\"配置-1\"><a href=\"#配置-1\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>打开根目录下的 <code>project.config.json</code> 文件，将其中的 <code>appid</code> 项修改为刚才注册小程序得到的 <strong>AppID</strong>。</p>\n<p>修改 <code>/client/config.json</code> 中的相关配置，说明如下：</p>\n<ul>\n<li>baseUrl: 接口地址，例如：<a href=\"https://www.izhaoo.com/api\">https://www.izhaoo.com/api</a></li>\n<li>webUrl: 网页博客地址（用于 WebView 跳转），例如：<a href=\"https://www.izhaoo.com\">https://www.izhaoo.com</a></li>\n<li>donate: 打赏二维码图片地址</li>\n</ul>\n<p>修改配置后需要重新打包。</p>\n<h3 id=\"上传\"><a href=\"#上传\" class=\"headerlink\" title=\"上传\"></a>上传</h3><p>首先下载 <a href=\"https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html\">微信小程序开发工具</a>。</p>\n<p>打开开发工具，新建项目，项目目录设置为 <code>hexo-weapp-zhaoo</code> 所在目录即可，点击【新建】完成项目创建。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705202742.jpg\"  ><span class=\"image-caption\">新建项目</span></p>\n<p>打开项目后可以进行 <em>预览</em> 或 <em>真机调试</em>，确认没问题后点击右侧的【上传】按钮，设置版本号，即可将小程序代码上传至云端。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705203106.jpg\"  ><span class=\"image-caption\">上传小程序</span></p>\n<p>网页打开微信公众平台后台，在 <em>管理 → 版本管理</em> 处将 <em>开发版本</em> 提交审核，审核通过后即可设置为 <em>正式版本</em>，至此小伙伴们就可以访问到你的小程序啦。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705203440.jpg\"  ><span class=\"image-caption\">提交审核</span></p>\n","more":"<h2 id=\"hexo-weapp-zhaoo\"><a href=\"#hexo-weapp-zhaoo\" class=\"headerlink\" title=\"hexo-weapp-zhaoo\"></a>hexo-weapp-zhaoo</h2><p style=\"text-align: center; font-weight: bold;\"><a href=\"https://github.com/zhaoo/hexo-weapp-zhaoo\" target=\"_blank\">hexo-weapp-zhaoo</a></p>\n\n<p style=\"text-align: center; font-weight: bold;\">为 Hexo 定制的博客小程序</p>\n\n<p><img  src=\"https://pic.izhaoo.com/weapp-code.jpg\"  ><span class=\"image-caption\">扫码预览</span></p>\n<h2 id=\"关于文档\"><a href=\"#关于文档\" class=\"headerlink\" title=\"关于文档\"></a>关于文档</h2><blockquote>\n<p>如有疑惑欢迎加鹅群咨询：<strong>550262893</strong><br>需要使用者具备一丢丢的前端基础。</p>\n</blockquote>\n<p style=\"text-align: right;\">文档更新于：2021年07月05日</p>\n\n<h2 id=\"RESTful\"><a href=\"#RESTful\" class=\"headerlink\" title=\"RESTful\"></a>RESTful</h2><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p>首先需要使用 <a href=\"https://github.com/zhaoo/hexo-generator-restful-zhaoo\">hexo-generator-restful-zhaoo</a> 插件生成 RESTful 接口，为小程序提供后端服务。</p>\n<p><code>cd</code> 到博客根目录，执行以下命令安装插件：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ npm install hexo-generator-restful-zhaoo --save  <span class=\"hljs-comment\"># 安装插件</span><br>$ hexo g  <span class=\"hljs-comment\"># 生成静态页面</span><br></code></pre></td></tr></table></figure>\n\n<p>生成静态页面后可在 <code>public</code> 目录下找到 <code>api</code> 目录，里面存放的是一些 <code>json</code> 格式的文本数据，直接访问这些 <code>json</code> 文件即可调用接口。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705142146.jpg\"  ><span class=\"image-caption\">调用接口</span></p>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>该插件暴露了一些配置项供用户进行自定义配置，在博客根目录下的 <code>_config.yml</code> 配置文件末尾插入以下内容进行配置：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"code\"><pre><code class=\"hljs yml\"><span class=\"hljs-comment\"># 以下为缺省默认项</span><br><br><span class=\"hljs-attr\">restful:</span><br>  <span class=\"hljs-comment\"># site 可配置为数组选择性生成某些属性</span><br>  <span class=\"hljs-comment\"># site: [&#x27;title&#x27;, &#x27;subtitle&#x27;, &#x27;description&#x27;, &#x27;author&#x27;, &#x27;since&#x27;, email&#x27;, &#x27;favicon&#x27;, &#x27;avatar&#x27;]</span><br>  <span class=\"hljs-attr\">site:</span> <span class=\"hljs-literal\">true</span>        <span class=\"hljs-comment\"># hexo.config mix theme.config</span><br>  <span class=\"hljs-attr\">posts_size:</span> <span class=\"hljs-number\">10</span>    <span class=\"hljs-comment\"># 文章列表分页，0 表示不分页</span><br>  <span class=\"hljs-attr\">posts_props:</span>      <span class=\"hljs-comment\"># 文章列表项的需要生成的属性</span><br>    <span class=\"hljs-attr\">title:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">slug:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">date:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">updated:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">comments:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">path:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">excerpt:</span> <span class=\"hljs-literal\">false</span><br>    <span class=\"hljs-attr\">cover:</span> <span class=\"hljs-literal\">true</span>      <span class=\"hljs-comment\"># 封面图，取文章第一张图片</span><br>    <span class=\"hljs-attr\">content:</span> <span class=\"hljs-literal\">false</span><br>    <span class=\"hljs-attr\">keywords:</span> <span class=\"hljs-literal\">false</span><br>    <span class=\"hljs-attr\">categories:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">tags:</span> <span class=\"hljs-literal\">true</span><br>  <span class=\"hljs-attr\">categories:</span> <span class=\"hljs-literal\">true</span>         <span class=\"hljs-comment\"># 分类数据</span><br>  <span class=\"hljs-attr\">use_category_slug:</span> <span class=\"hljs-literal\">false</span> <span class=\"hljs-comment\"># Use slug for filename of category data</span><br>  <span class=\"hljs-attr\">tags:</span> <span class=\"hljs-literal\">true</span>               <span class=\"hljs-comment\"># 标签数据</span><br>  <span class=\"hljs-attr\">use_tag_slug:</span> <span class=\"hljs-literal\">false</span>      <span class=\"hljs-comment\"># Use slug for filename of tag data</span><br>  <span class=\"hljs-attr\">post:</span> <span class=\"hljs-literal\">true</span>               <span class=\"hljs-comment\"># 文章数据</span><br>  <span class=\"hljs-attr\">pages:</span> <span class=\"hljs-literal\">false</span>             <span class=\"hljs-comment\"># 额外的 Hexo 页面数据, 如 About</span><br>  <span class=\"hljs-attr\">galleries:</span> <span class=\"hljs-literal\">false</span>         <span class=\"hljs-comment\"># 相册数据 </span><br></code></pre></td></tr></table></figure>\n\n<p>修改配置项后需要使用 <code>hexo g</code> 命令重新生成页面。</p>\n<h2 id=\"小程序\"><a href=\"#小程序\" class=\"headerlink\" title=\"小程序\"></a>小程序</h2><h3 id=\"注册\"><a href=\"#注册\" class=\"headerlink\" title=\"注册\"></a>注册</h3><p>首先需要在<a href=\"https://mp.weixin.qq.com/cgi-bin/registermidpage?action=index&lang=zh_CN&token=\">微信公众平台</a>注册一个小程序，填写基本信息即可。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705195454.jpg\"  ><span class=\"image-caption\">注册小程序</span></p>\n<p>注册完成后进入后台，在 <em>设置 → 基本设置</em> 中可以获取到 <strong>AppID</strong>，后面会使用到。</p>\n<p>在 <em>开发 → 开发管理 → 开发设置</em> 中添加 <em>request合法域名</em>，否则会被拦截，需要添加以下域名：</p>\n<ol>\n<li>RESTful 接口域名（例如：<a href=\"https://www.izhaoo.com）\">https://www.izhaoo.com）</a></li>\n<li><a href=\"https://api.leancloud.cn\">https://api.leancloud.cn</a> （第三方数据统计服务）</li>\n</ol>\n<h3 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h3><blockquote>\n<p>小程序基于 <a href=\"https://taro.aotu.io/\">Taro</a> 开发，建议阅读 <a href=\"https://taro-docs.jd.com/taro/docs/README\">Taro 官方文档</a> 了解更多姿势。</p>\n</blockquote>\n<p>首先需要安装 Taro <strong>（安全起见，建议安装 3.2.1 版本）</strong>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ npm install -g @tarojs/cli@3.2.1  <span class=\"hljs-comment\"># 安装 Taro</span><br>$ npm info @tarojs/cli  <span class=\"hljs-comment\"># 查看 Taro 版本</span><br></code></pre></td></tr></table></figure>\n\n<p>在任意目录下拉取 <a href=\"https://github.com/zhaoo/hexo-weapp-zhaoo\">hexo-weapp-zhaoo</a> 最新代码（直接打包下载也行）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ git <span class=\"hljs-built_in\">clone</span> https://github.com/zhaoo/hexo-weapp-zhaoo.git<br></code></pre></td></tr></table></figure>\n\n<p>执行以下命令打包小程序：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><code class=\"hljs bash\">$ <span class=\"hljs-built_in\">cd</span> client  <span class=\"hljs-comment\"># 移动到客户端目录</span><br>$ npm run build:weapp  <span class=\"hljs-comment\"># 打包</span><br></code></pre></td></tr></table></figure>\n\n<p>执行后会在当前目录下生成 <code>dist</code> 目录（小程序编译目标）。</p>\n<h3 id=\"配置-1\"><a href=\"#配置-1\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>打开根目录下的 <code>project.config.json</code> 文件，将其中的 <code>appid</code> 项修改为刚才注册小程序得到的 <strong>AppID</strong>。</p>\n<p>修改 <code>/client/config.json</code> 中的相关配置，说明如下：</p>\n<ul>\n<li>baseUrl: 接口地址，例如：<a href=\"https://www.izhaoo.com/api\">https://www.izhaoo.com/api</a></li>\n<li>webUrl: 网页博客地址（用于 WebView 跳转），例如：<a href=\"https://www.izhaoo.com\">https://www.izhaoo.com</a></li>\n<li>donate: 打赏二维码图片地址</li>\n</ul>\n<p>修改配置后需要重新打包。</p>\n<h3 id=\"上传\"><a href=\"#上传\" class=\"headerlink\" title=\"上传\"></a>上传</h3><p>首先下载 <a href=\"https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html\">微信小程序开发工具</a>。</p>\n<p>打开开发工具，新建项目，项目目录设置为 <code>hexo-weapp-zhaoo</code> 所在目录即可，点击【新建】完成项目创建。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705202742.jpg\"  ><span class=\"image-caption\">新建项目</span></p>\n<p>打开项目后可以进行 <em>预览</em> 或 <em>真机调试</em>，确认没问题后点击右侧的【上传】按钮，设置版本号，即可将小程序代码上传至云端。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705203106.jpg\"  ><span class=\"image-caption\">上传小程序</span></p>\n<p>网页打开微信公众平台后台，在 <em>管理 → 版本管理</em> 处将 <em>开发版本</em> 提交审核，审核通过后即可设置为 <em>正式版本</em>，至此小伙伴们就可以访问到你的小程序啦。</p>\n<p><img  src=\"https://pic.izhaoo.com/20210705203440.jpg\"  ><span class=\"image-caption\">提交审核</span></p>","categories":[{"name":"项目","path":"api/categories/项目.json"}],"tags":[{"name":"Hexo","path":"api/tags/Hexo.json"},{"name":"小程序","path":"api/tags/小程序.json"}]}